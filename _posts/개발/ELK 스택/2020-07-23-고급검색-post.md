---
title: "고급검색"
date: 2020-07-23 15:44:00 -0400
categories: ELK스택
---

## 은전한닢

-   자바 인터페이스와 스칼라 인터페이스의 두 종류를 제공
-   라이선스는 아파치 라이선스 2.0을 채택
-   현재 엘라스틱서치에서 가장 보편적으로 사용하는 한글 형태소 분석기

## 트위터 형태소분석기

-   트위터에서 한글을 처리하기 위해 개발한 형태소 분석기
-   트위터에서 직접 개발 했으나 2017년 4.4버전 이후로는 openkoreatext.org로 이관되어 오픈 소스로 개발되고 있음
-   현재 공식명칭도 open-korean-text라는 이름으로 변경
-   정규화, 토큰화, 스테밍, 어구 추출이 가능함

## Nori

-   루씬 프로젝에서 공식적으로 제공되는 한글 형태소 분석기인 Nori 엘라스틱서치 6.4버전에서 공식적으로 릴리즈 됨
-   라이선스로 아파치 라이선스 2.0을 채택했으며 엘라스틱의 유료 서비스를 사용하는 고객이라면 엘라스틱사에서 기술 지원을 받는 것도 가능
-   Nori는 서드파티 플러그인과 달리 루씬에서 공식적으로 지원되고 있지만 기본 플러그인으로는 포함돼 있지 않음
-   다른 서드파티 플러그인과 마찬가지로 직접 설치해야 함
-   Nori plugin 설치

```
$ ./bin/elasticsearch-plugin install analysis-nori
```

## Nori 분석기

### nori_tokenizer 토크나이저

토크나이저는 형태소를 토큰 형태로 분리하는데 사용. 내부적으로 세종 말뭉치와 mecab-ko-dic 사전을 사용

#### decompound_mode

-   복합명사를 토크나이저가 처리하는 방식을 결정함

| `파라미터 명` | `파리미터 값` | `설명`                                 | `예제`                   |
| :-----------: | :-----------: | :------------------------------------- | :----------------------- |
|  decompound   |     none      | 복합명사로 분리하지 않음               | 월미도<br>영종도         |
|               |    discard    | 복합명사로 분리하고 원본 데이터는 삭제 | 잠실역=>[잠실,역]        |
|               |     mixed     | 복합명사로 분리하고 원본 데이터는 유지 | 잠실역=>[잠실,역,잠실역] |

#### user_dictionary

-   사용자가 사전 정의한 명사를 사전에 추가로 등록할 수 있음
-   서버가 설치된 디렉터리 아래에 config/userdic_ko.txt 형태로 생성
-   userdic_ko.txt 파일에 명사 추가하는 방법
-   userdic_ko.txt

## 별칭을 이용해 항상 최신 인덱스 유지하기

-   사용중인 인덱스가 새로운 인덱스로 변경되되더라도 클라이언트는 그 사실을 전혀 눈치채지 못하도록 별칭(Alias) 기능을 제공
-   인덱스의 별칭을 이용하면 두 개 이상의 인덱스를 검색해야 할 때 한 번의 요청만으로도 모두 검색되도록 만들기도 쉬움
-   시나리오 : 맨 처음 moive*search 인덱스를 만들고 매일 신규 영화가 추가된 새로운 moive_search 인덱스를 추가로 만들고 싶다면 "movie_search*타임스탬프" 같은 형태로 인덱스를 생성하고 매일 새롭게 생성되는 인덱스에 별칭을 설정 - 오늘 moive_search_1544054400이라는 인덱스 생성 - 생성한 인덱스에는 moive_search라는 별칭을 설정 - 그리고 내일 movie_search_1544140800이라는 인덱스를 생성 - 내일이 되면 두 개의 인덱스를 서로 교체해서 항상 최신 데이터를 유지

```
POST _aliases
{
  "actions": [
    {"delete": { "index": "moive_search_1544054400", "alias": "movie_search" } },
    {"add": { "index": "movie_search_1544140800", "alias": "movie_search" } }
  ]
}
```
